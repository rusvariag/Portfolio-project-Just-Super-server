// ******************************************************************************************************************************
// Imports
// ******************************************************************************************************************************

const jwt = require('jsonwebtoken');

// Get configurations
const { SECRET } = require('../config');

// ******************************************************************************************************************************
// Validate request data
// ******************************************************************************************************************************

// Validate token on req
exports.token = (req, res, next) => {
    const token = req.headers.authorization.split(' ')[1];
    if (token) {
        const payload = jwt.verify(token, SECRET);
        req.userId = payload.id;
    }    
    next();
}
